// Code generated by iacg; DO NOT EDIT.
package wedata

import (
	"context"
	"fmt"
	"log"
	"strings"

	"github.com/hashicorp/terraform-plugin-sdk/v2/helper/resource"
	"github.com/hashicorp/terraform-plugin-sdk/v2/helper/schema"
	wedatav20250806 "github.com/tencentcloud/tencentcloud-sdk-go/tencentcloud/wedata/v20250806"
	tccommon "github.com/tencentcloudstack/terraform-provider-tencentcloud/tencentcloud/common"
	"github.com/tencentcloudstack/terraform-provider-tencentcloud/tencentcloud/internal/helper"
)

// System-generated key by default
var SystemGeneratedKey = []string{"sql.file.name", "ftp.file.name", "bucket", "region", "tenantId"}

func ResourceTencentCloudWedataTriggerTask() *schema.Resource {
	return &schema.Resource{
		Create: resourceTencentCloudWedataTriggerTaskCreate,
		Read:   resourceTencentCloudWedataTriggerTaskRead,
		Update: resourceTencentCloudWedataTriggerTaskUpdate,
		Delete: resourceTencentCloudWedataTriggerTaskDelete,
		Importer: &schema.ResourceImporter{
			State: schema.ImportStatePassthrough,
		},
		Schema: map[string]*schema.Schema{
			"project_id": {
				Type:        schema.TypeString,
				Required:    true,
				Description: "Project ID.",
			},

			"trigger_task_base_attribute": {
				Type:        schema.TypeList,
				Required:    true,
				MaxItems:    1,
				Description: "Basic task attributes.",
				Elem: &schema.Resource{
					Schema: map[string]*schema.Schema{
						"task_name": {
							Type:        schema.TypeString,
							Required:    true,
							Description: "Task name.",
						},
						"task_type_id": {
							Type:        schema.TypeString,
							Required:    true,
							Description: "Task type ID: `26`: OfflineSynchronization; `30`: Python; `32`: DLC SQL; `35`: Shell; `38`: Shell Form Mode; `46`: DLC Spark; `50`: DLC PySpark; `130`: Branch Node; `131`: Merged Node; `132`: Notebook; `133`: SSH; `137`: For-each; `139`: DLC Spark Streaming; `140`: Run Workflow.",
						},
						"workflow_id": {
							Type:        schema.TypeString,
							Required:    true,
							Description: "Workflow ID.",
						},
						"owner_uin": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Task owner ID, defaults to the current user.",
						},
						"task_description": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Task description.",
						},
						"task_folder_path": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Task folder path. Do not include the task node type in the path. For example, in a workflow named wf01 under the \"General\" category, to create a shell task in the tf_01 folder under this category, set the value to /tf_01. If the tf_01 folder does not exist, it must be created first (using the CreateTaskFolder API) before the operation can succeed.",
						},
					},
				},
			},

			"trigger_task_configuration": {
				Type:        schema.TypeList,
				Required:    true,
				MaxItems:    1,
				Description: "Task configuration.",
				Elem: &schema.Resource{
					Schema: map[string]*schema.Schema{
						"resource_group": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Resource group ID. Obtain ExecutorGroupId via DescribeNormalSchedulerExecutorGroups.",
						},
						"code_content": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Base64-encoded code content.",
						},
						"task_ext_configuration_list": {
							Type:        schema.TypeSet,
							Optional:    true,
							Computed:    true,
							Description: "Task extended attribute configuration list. `sql.file.name`, `ftp.file.name`, `bucket`, `region`, `tenantId` cannot be customized; they are generated by the system.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"param_key": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter name.",
									},
									"param_value": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter value.",
									},
								},
							},
						},
						"task_ext_configuration_system_list": {
							Type:        schema.TypeSet,
							Computed:    true,
							Description: "Configuration `sql.file.name`, `ftp.file.name`, `bucket`, `region`, `tenantId` generated by the system.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"param_key": {
										Type:        schema.TypeString,
										Computed:    true,
										Description: "Parameter name.",
									},
									"param_value": {
										Type:        schema.TypeString,
										Computed:    true,
										Description: "Parameter value.",
									},
								},
							},
						},
						"data_cluster": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Cluster ID.",
						},
						"broker_ip": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Specified execution node.",
						},
						"yarn_queue": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Resource pool queue name. Obtain via DescribeProjectClusterQueues.",
						},
						"source_service_id": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Source data source IDs, separated by semicolons (;). Obtain via DescribeDataSourceWithoutInfo.",
						},
						"source_service_type": {
							Type:        schema.TypeString,
							Optional:    true,
							Computed:    true,
							Description: "The source data source type needs to be obtained through DescribeDataSourceWithoutInfo.",
						},
						"source_service_name": {
							Type:        schema.TypeString,
							Optional:    true,
							Computed:    true,
							Description: "The source data source name needs to be obtained through DescribeDataSourceWithoutInfo..",
						},
						"target_service_id": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Target data source IDs, separated by semicolons (;). Obtain via DescribeDataSourceWithoutInfo.",
						},
						"target_service_type": {
							Type:        schema.TypeString,
							Optional:    true,
							Computed:    true,
							Description: "The target data source type needs to be obtained through DescribeDataSourceWithoutInfo.",
						},
						"target_service_name": {
							Type:        schema.TypeString,
							Optional:    true,
							Computed:    true,
							Description: "The target data source name, which needs to be obtained through DescribeDataSourceWithoutInfo.",
						},
						"task_scheduling_parameter_list": {
							Type:        schema.TypeList,
							Optional:    true,
							Description: "Scheduling parameters.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"param_key": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter name.",
									},
									"param_value": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter value.",
									},
								},
							},
						},
						"bundle_id": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Bundle ID in use.",
						},
						"bundle_info": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Bundle information.",
						},
					},
				},
			},

			"trigger_task_scheduler_configuration": {
				Type:        schema.TypeList,
				Required:    true,
				MaxItems:    1,
				Description: "Task scheduling configuration.",
				Elem: &schema.Resource{
					Schema: map[string]*schema.Schema{
						"upstream_dependency_config_list": {
							Type:        schema.TypeList,
							Optional:    true,
							Description: "List of upstream dependent tasks.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"task_id": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Task ID.",
									},
								},
							},
						},
						"run_priority_type": {
							Type:        schema.TypeInt,
							Optional:    true,
							Description: "Task scheduling priority. Run priority: `4`-High; `5`-Medium; `6`-Low. Default: 6.",
						},
						"retry_wait_minute": {
							Type:        schema.TypeInt,
							Optional:    true,
							Description: "Retry policy. Retry wait time in minutes. Default: 5.",
						},
						"max_retry_number": {
							Type:        schema.TypeInt,
							Optional:    true,
							Description: "Retry policy. Maximum retry attempts. Default: 4.",
						},
						"execution_ttl_minute": {
							Type:        schema.TypeInt,
							Optional:    true,
							Description: "Timeout handling policy. Execution timeout in minutes. Default: -1.",
						},
						"wait_execution_total_ttl_minute": {
							Type:        schema.TypeInt,
							Optional:    true,
							Description: "Timeout handling policy. Total wait timeout in minutes. Default: -1.",
						},
						"allow_redo_type": {
							Type:        schema.TypeString,
							Optional:    true,
							Description: "Rerun & backfill configuration. Default: ALL. ALL: rerun or backfill allowed after success or failure; FAILURE: not allowed after success, allowed after failure; NONE: not allowed after success or failure.",
						},
						"param_task_out_list": {
							Type:        schema.TypeList,
							Optional:    true,
							Description: "Output parameter list.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"param_key": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter name.",
									},
									"param_value": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter definition.",
									},
								},
							},
						},
						"param_task_in_list": {
							Type:        schema.TypeList,
							Optional:    true,
							Description: "Input parameter list.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"param_key": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter name.",
									},
									"param_desc": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parameter description. Format: project_identifier.task_name.parameter_name; e.g., project_wedata_1.sh_250820_104107.pp_out.",
									},
									"from_task_id": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parent task ID.",
									},
									"from_param_key": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Parent task parameter key.",
									},
								},
							},
						},
						"task_output_registry_list": {
							Type:        schema.TypeList,
							Optional:    true,
							Description: "Output registry.",
							Elem: &schema.Resource{
								Schema: map[string]*schema.Schema{
									"datasource_id": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Data source ID.",
									},
									"database_name": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Database name.",
									},
									"table_name": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Table name.",
									},
									"partition_name": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Partition name.",
									},
									"data_flow_type": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Input/output table type: input stream: `UPSTREAM`, output stream: `DOWNSTREAM`.",
									},
									"table_physical_id": {
										Type:        schema.TypeString,
										Required:    true,
										Description: "Table physical unique ID.",
									},
									"db_guid": {
										Type:        schema.TypeString,
										Optional:    true,
										Description: "Database unique identifier.",
									},
									"table_guid": {
										Type:        schema.TypeString,
										Optional:    true,
										Description: "Table unique identifier.",
									},
								},
							},
						},
					},
				},
			},
		},
	}
}

func resourceTencentCloudWedataTriggerTaskCreate(d *schema.ResourceData, meta interface{}) error {
	defer tccommon.LogElapsed("resource.tencentcloud_wedata_trigger_task.create")()
	defer tccommon.InconsistentCheck(d, meta)()

	logId := tccommon.GetLogId(tccommon.ContextNil)

	ctx := tccommon.NewResourceLifeCycleHandleFuncContext(context.Background(), logId, d, meta)

	var (
		projectId string
		taskId    string
	)
	var (
		request  = wedatav20250806.NewCreateTriggerTaskRequest()
		response = wedatav20250806.NewCreateTriggerTaskResponse()
	)

	if v, ok := d.GetOk("project_id"); ok {
		request.ProjectId = helper.String(v.(string))
		projectId = v.(string)
	}

	if triggerTaskBaseAttributeMap, ok := helper.InterfacesHeadMap(d, "trigger_task_base_attribute"); ok {
		createTriggerTaskBaseAttribute := wedatav20250806.CreateTriggerTaskBaseAttribute{}
		if v, ok := triggerTaskBaseAttributeMap["task_name"].(string); ok && v != "" {
			createTriggerTaskBaseAttribute.TaskName = helper.String(v)
		}
		if v, ok := triggerTaskBaseAttributeMap["task_type_id"].(string); ok && v != "" {
			createTriggerTaskBaseAttribute.TaskTypeId = helper.String(v)
		}
		if v, ok := triggerTaskBaseAttributeMap["workflow_id"].(string); ok && v != "" {
			createTriggerTaskBaseAttribute.WorkflowId = helper.String(v)
		}
		if v, ok := triggerTaskBaseAttributeMap["owner_uin"].(string); ok && v != "" {
			createTriggerTaskBaseAttribute.OwnerUin = helper.String(v)
		}
		if v, ok := triggerTaskBaseAttributeMap["task_description"].(string); ok && v != "" {
			createTriggerTaskBaseAttribute.TaskDescription = helper.String(v)
		}
		if v, ok := triggerTaskBaseAttributeMap["task_folder_path"].(string); ok && v != "" {
			createTriggerTaskBaseAttribute.TaskFolderPath = helper.String(v)
		}
		request.TriggerTaskBaseAttribute = &createTriggerTaskBaseAttribute
	}

	if triggerTaskConfigurationMap, ok := helper.InterfacesHeadMap(d, "trigger_task_configuration"); ok {
		createTriggerTaskConfiguration := wedatav20250806.CreateTriggerTaskConfiguration{}
		if v, ok := triggerTaskConfigurationMap["resource_group"].(string); ok && v != "" {
			createTriggerTaskConfiguration.ResourceGroup = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["code_content"].(string); ok && v != "" {
			createTriggerTaskConfiguration.CodeContent = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["task_ext_configuration_list"]; ok {
			taskExtConfigurationSet := v.(*schema.Set).List()
			for _, item := range taskExtConfigurationSet {
				taskExtConfigurationListMap := item.(map[string]interface{})
				taskExtParameter := wedatav20250806.TaskExtParameter{}
				if v, ok := taskExtConfigurationListMap["param_key"].(string); ok && v != "" {
					taskExtParameter.ParamKey = helper.String(v)
				}
				if v, ok := taskExtConfigurationListMap["param_value"].(string); ok && v != "" {
					taskExtParameter.ParamValue = helper.String(v)
				}
				createTriggerTaskConfiguration.TaskExtConfigurationList = append(createTriggerTaskConfiguration.TaskExtConfigurationList, &taskExtParameter)
			}
		}
		if v, ok := triggerTaskConfigurationMap["data_cluster"].(string); ok && v != "" {
			createTriggerTaskConfiguration.DataCluster = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["broker_ip"].(string); ok && v != "" {
			createTriggerTaskConfiguration.BrokerIp = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["yarn_queue"].(string); ok && v != "" {
			createTriggerTaskConfiguration.YarnQueue = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["source_service_id"].(string); ok && v != "" {
			createTriggerTaskConfiguration.SourceServiceId = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["target_service_id"].(string); ok && v != "" {
			createTriggerTaskConfiguration.TargetServiceId = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["task_scheduling_parameter_list"]; ok {
			for _, item := range v.([]interface{}) {
				taskSchedulingParameterListMap := item.(map[string]interface{})
				taskSchedulingParameter := wedatav20250806.TaskSchedulingParameter{}
				if v, ok := taskSchedulingParameterListMap["param_key"].(string); ok && v != "" {
					taskSchedulingParameter.ParamKey = helper.String(v)
				}
				if v, ok := taskSchedulingParameterListMap["param_value"].(string); ok && v != "" {
					taskSchedulingParameter.ParamValue = helper.String(v)
				}
				createTriggerTaskConfiguration.TaskSchedulingParameterList = append(createTriggerTaskConfiguration.TaskSchedulingParameterList, &taskSchedulingParameter)
			}
		}
		if v, ok := triggerTaskConfigurationMap["bundle_id"].(string); ok && v != "" {
			createTriggerTaskConfiguration.BundleId = helper.String(v)
		}
		if v, ok := triggerTaskConfigurationMap["bundle_info"].(string); ok && v != "" {
			createTriggerTaskConfiguration.BundleInfo = helper.String(v)
		}
		request.TriggerTaskConfiguration = &createTriggerTaskConfiguration
	}

	if triggerTaskSchedulerConfigurationMap, ok := helper.InterfacesHeadMap(d, "trigger_task_scheduler_configuration"); ok {
		createTriggerTaskSchedulerConfiguration := wedatav20250806.CreateTriggerTaskSchedulerConfiguration{}
		if v, ok := triggerTaskSchedulerConfigurationMap["upstream_dependency_config_list"]; ok {
			for _, item := range v.([]interface{}) {
				upstreamDependencyConfigListMap := item.(map[string]interface{})
				dependencyTriggerTaskBrief := wedatav20250806.DependencyTriggerTaskBrief{}
				if v, ok := upstreamDependencyConfigListMap["task_id"].(string); ok && v != "" {
					dependencyTriggerTaskBrief.TaskId = helper.String(v)
				}
				createTriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList = append(createTriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList, &dependencyTriggerTaskBrief)
			}
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["run_priority_type"].(int); ok {
			createTriggerTaskSchedulerConfiguration.RunPriorityType = helper.IntInt64(v)
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["retry_wait_minute"].(int); ok {
			createTriggerTaskSchedulerConfiguration.RetryWaitMinute = helper.IntInt64(v)
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["max_retry_number"].(int); ok {
			createTriggerTaskSchedulerConfiguration.MaxRetryNumber = helper.IntInt64(v)
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["execution_ttl_minute"].(int); ok {
			createTriggerTaskSchedulerConfiguration.ExecutionTTLMinute = helper.IntInt64(v)
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["wait_execution_total_ttl_minute"].(int); ok {
			createTriggerTaskSchedulerConfiguration.WaitExecutionTotalTTLMinute = helper.IntInt64(v)
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["allow_redo_type"].(string); ok && v != "" {
			createTriggerTaskSchedulerConfiguration.AllowRedoType = helper.String(v)
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["param_task_out_list"]; ok {
			for _, item := range v.([]interface{}) {
				paramTaskOutListMap := item.(map[string]interface{})
				outTaskParameter := wedatav20250806.OutTaskParameter{}
				if v, ok := paramTaskOutListMap["param_key"].(string); ok && v != "" {
					outTaskParameter.ParamKey = helper.String(v)
				}
				if v, ok := paramTaskOutListMap["param_value"].(string); ok && v != "" {
					outTaskParameter.ParamValue = helper.String(v)
				}
				createTriggerTaskSchedulerConfiguration.ParamTaskOutList = append(createTriggerTaskSchedulerConfiguration.ParamTaskOutList, &outTaskParameter)
			}
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["param_task_in_list"]; ok {
			for _, item := range v.([]interface{}) {
				paramTaskInListMap := item.(map[string]interface{})
				inTaskParameter := wedatav20250806.InTaskParameter{}
				if v, ok := paramTaskInListMap["param_key"].(string); ok && v != "" {
					inTaskParameter.ParamKey = helper.String(v)
				}
				if v, ok := paramTaskInListMap["param_desc"].(string); ok && v != "" {
					inTaskParameter.ParamDesc = helper.String(v)
				}
				if v, ok := paramTaskInListMap["from_task_id"].(string); ok && v != "" {
					inTaskParameter.FromTaskId = helper.String(v)
				}
				if v, ok := paramTaskInListMap["from_param_key"].(string); ok && v != "" {
					inTaskParameter.FromParamKey = helper.String(v)
				}
				createTriggerTaskSchedulerConfiguration.ParamTaskInList = append(createTriggerTaskSchedulerConfiguration.ParamTaskInList, &inTaskParameter)
			}
		}
		if v, ok := triggerTaskSchedulerConfigurationMap["task_output_registry_list"]; ok {
			for _, item := range v.([]interface{}) {
				taskOutputRegistryListMap := item.(map[string]interface{})
				taskDataRegistry := wedatav20250806.TaskDataRegistry{}
				if v, ok := taskOutputRegistryListMap["datasource_id"].(string); ok && v != "" {
					taskDataRegistry.DatasourceId = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["database_name"].(string); ok && v != "" {
					taskDataRegistry.DatabaseName = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["table_name"].(string); ok && v != "" {
					taskDataRegistry.TableName = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["partition_name"].(string); ok && v != "" {
					taskDataRegistry.PartitionName = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["data_flow_type"].(string); ok && v != "" {
					taskDataRegistry.DataFlowType = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["table_physical_id"].(string); ok && v != "" {
					taskDataRegistry.TablePhysicalId = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["db_guid"].(string); ok && v != "" {
					taskDataRegistry.DbGuid = helper.String(v)
				}
				if v, ok := taskOutputRegistryListMap["table_guid"].(string); ok && v != "" {
					taskDataRegistry.TableGuid = helper.String(v)
				}
				createTriggerTaskSchedulerConfiguration.TaskOutputRegistryList = append(createTriggerTaskSchedulerConfiguration.TaskOutputRegistryList, &taskDataRegistry)
			}
		}
		request.TriggerTaskSchedulerConfiguration = &createTriggerTaskSchedulerConfiguration
	}

	reqErr := resource.Retry(tccommon.WriteRetryTimeout, func() *resource.RetryError {
		result, e := meta.(tccommon.ProviderMeta).GetAPIV3Conn().UseWedataV20250806Client().CreateTriggerTaskWithContext(ctx, request)
		if e != nil {
			return tccommon.RetryError(e)
		} else {
			log.Printf("[DEBUG]%s api[%s] success, request body [%s], response body [%s]\n", logId, request.GetAction(), request.ToJsonString(), result.ToJsonString())
		}
		response = result
		return nil
	})
	if reqErr != nil {
		log.Printf("[CRITAL]%s create wedata trigger task failed, reason:%+v", logId, reqErr)
		return reqErr
	}
	if response == nil || response.Response == nil || response.Response.Data == nil || response.Response.Data.TaskId == nil {
		return fmt.Errorf("wedata trigger task id is nil")
	}
	taskId = *response.Response.Data.TaskId

	d.SetId(strings.Join([]string{projectId, taskId}, tccommon.FILED_SP))

	return resourceTencentCloudWedataTriggerTaskRead(d, meta)
}

func resourceTencentCloudWedataTriggerTaskRead(d *schema.ResourceData, meta interface{}) error {
	defer tccommon.LogElapsed("resource.tencentcloud_wedata_trigger_task.read")()
	defer tccommon.InconsistentCheck(d, meta)()

	logId := tccommon.GetLogId(tccommon.ContextNil)

	ctx := tccommon.NewResourceLifeCycleHandleFuncContext(context.Background(), logId, d, meta)

	service := WedataService{client: meta.(tccommon.ProviderMeta).GetAPIV3Conn()}

	idSplit := strings.Split(d.Id(), tccommon.FILED_SP)
	if len(idSplit) != 2 {
		return fmt.Errorf("id is broken,%s", d.Id())
	}
	projectId := idSplit[0]
	taskId := idSplit[1]

	respData, err := service.DescribeWedataTriggerTaskById(ctx, projectId, taskId)
	if err != nil {
		return err
	}

	if respData == nil {
		d.SetId("")
		log.Printf("[WARN]%s resource `wedata_trigger_task` [%s] not found, please check if it has been deleted.\n", logId, d.Id())
		return nil
	}

	_ = d.Set("project_id", projectId)

	if respData.TriggerTaskBaseAttribute != nil {
		triggerTaskBaseAttributeMap := map[string]interface{}{}
		if respData.TriggerTaskBaseAttribute.TaskTypeId != nil {
			triggerTaskBaseAttributeMap["task_type_id"] = fmt.Sprintf("%d", *respData.TriggerTaskBaseAttribute.TaskTypeId)
		}

		if respData.TriggerTaskBaseAttribute.WorkflowId != nil {
			triggerTaskBaseAttributeMap["workflow_id"] = respData.TriggerTaskBaseAttribute.WorkflowId
		}

		if respData.TriggerTaskBaseAttribute.TaskName != nil {
			triggerTaskBaseAttributeMap["task_name"] = respData.TriggerTaskBaseAttribute.TaskName
		}

		if respData.TriggerTaskBaseAttribute.OwnerUin != nil {
			triggerTaskBaseAttributeMap["owner_uin"] = respData.TriggerTaskBaseAttribute.OwnerUin
		}

		if respData.TriggerTaskBaseAttribute.TaskDescription != nil {
			triggerTaskBaseAttributeMap["task_description"] = respData.TriggerTaskBaseAttribute.TaskDescription
		}

		if respData.TriggerTaskBaseAttribute.TaskFolderPath != nil {
			triggerTaskBaseAttributeMap["task_folder_path"] = respData.TriggerTaskBaseAttribute.TaskFolderPath
		}

		_ = d.Set("trigger_task_base_attribute", []interface{}{triggerTaskBaseAttributeMap})
	}

	if respData.TriggerTaskConfiguration != nil {
		triggerTaskConfigurationMap := map[string]interface{}{}
		if respData.TriggerTaskConfiguration.CodeContent != nil {
			triggerTaskConfigurationMap["code_content"] = respData.TriggerTaskConfiguration.CodeContent
		}

		taskExtConfigurationListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskConfiguration.TaskExtConfigurationList))
		taskExtConfigurationSystemListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskConfiguration.TaskExtConfigurationList))
		if respData.TriggerTaskConfiguration.TaskExtConfigurationList != nil {
			for _, taskExtConfigurationList := range respData.TriggerTaskConfiguration.TaskExtConfigurationList {
				taskExtConfigurationListMap := map[string]interface{}{}

				if taskExtConfigurationList.ParamKey != nil && taskExtConfigurationList.ParamValue != nil &&
					*taskExtConfigurationList.ParamValue != "" {
					taskExtConfigurationListMap["param_key"] = taskExtConfigurationList.ParamKey
					taskExtConfigurationListMap["param_value"] = taskExtConfigurationList.ParamValue

					if helper.StringsContain(SystemGeneratedKey, *taskExtConfigurationList.ParamKey) {
						taskExtConfigurationSystemListList = append(taskExtConfigurationSystemListList, taskExtConfigurationListMap)
					} else {
						taskExtConfigurationListList = append(taskExtConfigurationListList, taskExtConfigurationListMap)
					}
				}
			}

			triggerTaskConfigurationMap["task_ext_configuration_list"] = taskExtConfigurationListList
			triggerTaskConfigurationMap["task_ext_configuration_system_list"] = taskExtConfigurationSystemListList
		}
		if respData.TriggerTaskConfiguration.DataCluster != nil {
			triggerTaskConfigurationMap["data_cluster"] = respData.TriggerTaskConfiguration.DataCluster
		}

		if respData.TriggerTaskConfiguration.BrokerIp != nil {
			triggerTaskConfigurationMap["broker_ip"] = respData.TriggerTaskConfiguration.BrokerIp
		}

		if respData.TriggerTaskConfiguration.YarnQueue != nil {
			triggerTaskConfigurationMap["yarn_queue"] = respData.TriggerTaskConfiguration.YarnQueue
		}

		if respData.TriggerTaskConfiguration.SourceServiceId != nil {
			triggerTaskConfigurationMap["source_service_id"] = respData.TriggerTaskConfiguration.SourceServiceId
		}

		if respData.TriggerTaskConfiguration.SourceServiceType != nil {
			triggerTaskConfigurationMap["source_service_type"] = respData.TriggerTaskConfiguration.SourceServiceType
		}

		if respData.TriggerTaskConfiguration.SourceServiceName != nil {
			triggerTaskConfigurationMap["source_service_name"] = respData.TriggerTaskConfiguration.SourceServiceName
		}

		if respData.TriggerTaskConfiguration.TargetServiceId != nil {
			triggerTaskConfigurationMap["target_service_id"] = respData.TriggerTaskConfiguration.TargetServiceId
		}

		if respData.TriggerTaskConfiguration.TargetServiceType != nil {
			triggerTaskConfigurationMap["target_service_type"] = respData.TriggerTaskConfiguration.TargetServiceType
		}

		if respData.TriggerTaskConfiguration.TargetServiceName != nil {
			triggerTaskConfigurationMap["target_service_name"] = respData.TriggerTaskConfiguration.TargetServiceName
		}

		if respData.TriggerTaskConfiguration.ResourceGroup != nil {
			triggerTaskConfigurationMap["resource_group"] = respData.TriggerTaskConfiguration.ResourceGroup
		}

		if respData.TriggerTaskConfiguration.ResourceGroupName != nil {
			triggerTaskConfigurationMap["resource_group_name"] = respData.TriggerTaskConfiguration.ResourceGroupName
		}

		taskSchedulingParameterListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskConfiguration.TaskSchedulingParameterList))
		if respData.TriggerTaskConfiguration.TaskSchedulingParameterList != nil {
			for _, taskSchedulingParameterList := range respData.TriggerTaskConfiguration.TaskSchedulingParameterList {
				taskSchedulingParameterListMap := map[string]interface{}{}

				if taskSchedulingParameterList.ParamKey != nil {
					taskSchedulingParameterListMap["param_key"] = taskSchedulingParameterList.ParamKey
				}

				if taskSchedulingParameterList.ParamValue != nil {
					taskSchedulingParameterListMap["param_value"] = taskSchedulingParameterList.ParamValue
				}

				taskSchedulingParameterListList = append(taskSchedulingParameterListList, taskSchedulingParameterListMap)
			}

			triggerTaskConfigurationMap["task_scheduling_parameter_list"] = taskSchedulingParameterListList
		}
		if respData.TriggerTaskConfiguration.BundleId != nil {
			triggerTaskConfigurationMap["bundle_id"] = respData.TriggerTaskConfiguration.BundleId
		}

		if respData.TriggerTaskConfiguration.BundleInfo != nil {
			triggerTaskConfigurationMap["bundle_info"] = respData.TriggerTaskConfiguration.BundleInfo
		}

		_ = d.Set("trigger_task_configuration", []interface{}{triggerTaskConfigurationMap})
	}

	if respData.TriggerTaskSchedulerConfiguration != nil {
		triggerTaskSchedulerConfigurationMap := map[string]interface{}{}
		upstreamDependencyConfigListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList))
		if respData.TriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList != nil {
			for _, upstreamDependencyConfigList := range respData.TriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList {
				upstreamDependencyConfigListMap := map[string]interface{}{}

				if upstreamDependencyConfigList.TaskId != nil {
					upstreamDependencyConfigListMap["task_id"] = upstreamDependencyConfigList.TaskId
				}

				upstreamDependencyConfigListList = append(upstreamDependencyConfigListList, upstreamDependencyConfigListMap)
			}

			triggerTaskSchedulerConfigurationMap["upstream_dependency_config_list"] = upstreamDependencyConfigListList
		}
		if respData.TriggerTaskSchedulerConfiguration.RunPriorityType != nil {
			triggerTaskSchedulerConfigurationMap["run_priority_type"] = respData.TriggerTaskSchedulerConfiguration.RunPriorityType
		}

		if respData.TriggerTaskSchedulerConfiguration.RetryWaitMinute != nil {
			triggerTaskSchedulerConfigurationMap["retry_wait_minute"] = respData.TriggerTaskSchedulerConfiguration.RetryWaitMinute
		}

		if respData.TriggerTaskSchedulerConfiguration.MaxRetryNumber != nil {
			triggerTaskSchedulerConfigurationMap["max_retry_number"] = respData.TriggerTaskSchedulerConfiguration.MaxRetryNumber
		}

		if respData.TriggerTaskSchedulerConfiguration.ExecutionTTLMinute != nil {
			triggerTaskSchedulerConfigurationMap["execution_ttl_minute"] = respData.TriggerTaskSchedulerConfiguration.ExecutionTTLMinute
		}

		if respData.TriggerTaskSchedulerConfiguration.WaitExecutionTotalTTLMinute != nil {
			triggerTaskSchedulerConfigurationMap["wait_execution_total_ttl_minute"] = respData.TriggerTaskSchedulerConfiguration.WaitExecutionTotalTTLMinute
		}

		if respData.TriggerTaskSchedulerConfiguration.AllowRedoType != nil {
			triggerTaskSchedulerConfigurationMap["allow_redo_type"] = respData.TriggerTaskSchedulerConfiguration.AllowRedoType
		}

		paramTaskOutListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskSchedulerConfiguration.ParamTaskOutList))
		if respData.TriggerTaskSchedulerConfiguration.ParamTaskOutList != nil {
			for _, paramTaskOutList := range respData.TriggerTaskSchedulerConfiguration.ParamTaskOutList {
				paramTaskOutListMap := map[string]interface{}{}

				if paramTaskOutList.ParamKey != nil {
					paramTaskOutListMap["param_key"] = paramTaskOutList.ParamKey
				}

				if paramTaskOutList.ParamValue != nil {
					paramTaskOutListMap["param_value"] = paramTaskOutList.ParamValue
				}

				paramTaskOutListList = append(paramTaskOutListList, paramTaskOutListMap)
			}

			triggerTaskSchedulerConfigurationMap["param_task_out_list"] = paramTaskOutListList
		}
		paramTaskInListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskSchedulerConfiguration.ParamTaskInList))
		if respData.TriggerTaskSchedulerConfiguration.ParamTaskInList != nil {
			for _, paramTaskInList := range respData.TriggerTaskSchedulerConfiguration.ParamTaskInList {
				paramTaskInListMap := map[string]interface{}{}

				if paramTaskInList.ParamKey != nil {
					paramTaskInListMap["param_key"] = paramTaskInList.ParamKey
				}

				if paramTaskInList.ParamDesc != nil {
					paramTaskInListMap["param_desc"] = paramTaskInList.ParamDesc
				}

				if paramTaskInList.FromTaskId != nil {
					paramTaskInListMap["from_task_id"] = paramTaskInList.FromTaskId
				}

				if paramTaskInList.FromParamKey != nil {
					paramTaskInListMap["from_param_key"] = paramTaskInList.FromParamKey
				}

				paramTaskInListList = append(paramTaskInListList, paramTaskInListMap)
			}

			triggerTaskSchedulerConfigurationMap["param_task_in_list"] = paramTaskInListList
		}
		taskOutputRegistryListList := make([]map[string]interface{}, 0, len(respData.TriggerTaskSchedulerConfiguration.TaskOutputRegistryList))
		if respData.TriggerTaskSchedulerConfiguration.TaskOutputRegistryList != nil {
			for _, taskOutputRegistryList := range respData.TriggerTaskSchedulerConfiguration.TaskOutputRegistryList {
				taskOutputRegistryListMap := map[string]interface{}{}

				if taskOutputRegistryList.DatasourceId != nil {
					taskOutputRegistryListMap["datasource_id"] = taskOutputRegistryList.DatasourceId
				}

				if taskOutputRegistryList.DatabaseName != nil {
					taskOutputRegistryListMap["database_name"] = taskOutputRegistryList.DatabaseName
				}

				if taskOutputRegistryList.TableName != nil {
					taskOutputRegistryListMap["table_name"] = taskOutputRegistryList.TableName
				}

				if taskOutputRegistryList.PartitionName != nil {
					taskOutputRegistryListMap["partition_name"] = taskOutputRegistryList.PartitionName
				}

				if taskOutputRegistryList.DataFlowType != nil {
					taskOutputRegistryListMap["data_flow_type"] = taskOutputRegistryList.DataFlowType
				}

				if taskOutputRegistryList.TablePhysicalId != nil {
					taskOutputRegistryListMap["table_physical_id"] = taskOutputRegistryList.TablePhysicalId
				}

				if taskOutputRegistryList.DbGuid != nil {
					taskOutputRegistryListMap["db_guid"] = taskOutputRegistryList.DbGuid
				}

				if taskOutputRegistryList.TableGuid != nil {
					taskOutputRegistryListMap["table_guid"] = taskOutputRegistryList.TableGuid
				}

				taskOutputRegistryListList = append(taskOutputRegistryListList, taskOutputRegistryListMap)
			}

			triggerTaskSchedulerConfigurationMap["task_output_registry_list"] = taskOutputRegistryListList
		}
		_ = d.Set("trigger_task_scheduler_configuration", []interface{}{triggerTaskSchedulerConfigurationMap})
	}

	_ = projectId
	_ = taskId
	return nil
}

func resourceTencentCloudWedataTriggerTaskUpdate(d *schema.ResourceData, meta interface{}) error {
	defer tccommon.LogElapsed("resource.tencentcloud_wedata_trigger_task.update")()
	defer tccommon.InconsistentCheck(d, meta)()

	logId := tccommon.GetLogId(tccommon.ContextNil)

	ctx := tccommon.NewResourceLifeCycleHandleFuncContext(context.Background(), logId, d, meta)

	immutableArgs := []string{"project_id", "task_id"}
	for _, v := range immutableArgs {
		if d.HasChange(v) {
			return fmt.Errorf("argument `%s` cannot be changed", v)
		}
	}
	idSplit := strings.Split(d.Id(), tccommon.FILED_SP)
	if len(idSplit) != 2 {
		return fmt.Errorf("id is broken,%s", d.Id())
	}
	projectId := idSplit[0]
	taskId := idSplit[1]

	needChange := false
	mutableArgs := []string{"trigger_task_base_attribute", "trigger_task_configuration", "trigger_task_scheduler_configuration"}
	for _, v := range mutableArgs {
		if d.HasChange(v) {
			needChange = true
			break
		}
	}

	if needChange {
		request := wedatav20250806.NewUpdateTriggerTaskRequest()
		request.ProjectId = &projectId
		request.TaskId = &taskId

		task := wedatav20250806.UpdateTriggerTaskBrief{}
		if triggerTaskBaseAttributeMap, ok := helper.InterfacesHeadMap(d, "trigger_task_base_attribute"); ok {
			updateTriggerTaskBaseAttribute := wedatav20250806.UpdateTriggerTaskBaseAttribute{}
			if v, ok := triggerTaskBaseAttributeMap["task_name"].(string); ok && v != "" {
				updateTriggerTaskBaseAttribute.TaskName = helper.String(v)
			}
			if v, ok := triggerTaskBaseAttributeMap["owner_uin"].(string); ok && v != "" {
				updateTriggerTaskBaseAttribute.OwnerUin = helper.String(v)
			}
			if v, ok := triggerTaskBaseAttributeMap["task_description"].(string); ok && v != "" {
				updateTriggerTaskBaseAttribute.TaskDescription = helper.String(v)
			}
			if v, ok := triggerTaskBaseAttributeMap["task_folder_path"].(string); ok && v != "" {
				updateTriggerTaskBaseAttribute.TaskFolderPath = helper.String(v)
			}
			task.TriggerTaskBaseAttribute = &updateTriggerTaskBaseAttribute
		}

		if triggerTaskConfigurationMap, ok := helper.InterfacesHeadMap(d, "trigger_task_configuration"); ok {
			updateTriggerTaskConfiguration := wedatav20250806.TriggerTaskConfiguration{}
			if v, ok := triggerTaskConfigurationMap["resource_group"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.ResourceGroup = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["code_content"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.CodeContent = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["task_ext_configuration_list"]; ok {
				taskExtConfigurationSet := v.(*schema.Set).List()
				for _, item := range taskExtConfigurationSet {
					taskExtConfigurationListMap := item.(map[string]interface{})
					taskExtParameter := wedatav20250806.TaskExtParameter{}
					if v, ok := taskExtConfigurationListMap["param_key"].(string); ok && v != "" {
						taskExtParameter.ParamKey = helper.String(v)
					}
					if v, ok := taskExtConfigurationListMap["param_value"].(string); ok && v != "" {
						taskExtParameter.ParamValue = helper.String(v)
					}
					updateTriggerTaskConfiguration.TaskExtConfigurationList = append(updateTriggerTaskConfiguration.TaskExtConfigurationList, &taskExtParameter)
				}
			}
			if v, ok := triggerTaskConfigurationMap["task_ext_configuration_system_list"]; ok {
				taskExtConfigurationSet := v.(*schema.Set).List()
				for _, item := range taskExtConfigurationSet {
					taskExtConfigurationListMap := item.(map[string]interface{})
					taskExtParameter := wedatav20250806.TaskExtParameter{}
					if v, ok := taskExtConfigurationListMap["param_key"].(string); ok && v != "" {
						taskExtParameter.ParamKey = helper.String(v)
					}
					if v, ok := taskExtConfigurationListMap["param_value"].(string); ok && v != "" {
						taskExtParameter.ParamValue = helper.String(v)
					}
					updateTriggerTaskConfiguration.TaskExtConfigurationList = append(updateTriggerTaskConfiguration.TaskExtConfigurationList, &taskExtParameter)
				}
			}
			if v, ok := triggerTaskConfigurationMap["data_cluster"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.DataCluster = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["broker_ip"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.BrokerIp = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["yarn_queue"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.YarnQueue = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["source_service_id"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.SourceServiceId = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["source_service_type"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.SourceServiceType = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["source_service_name"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.SourceServiceName = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["target_service_id"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.TargetServiceId = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["target_service_type"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.TargetServiceType = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["target_service_name"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.TargetServiceName = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["task_scheduling_parameter_list"]; ok {
				for _, item := range v.([]interface{}) {
					taskSchedulingParameterListMap := item.(map[string]interface{})
					taskSchedulingParameter := wedatav20250806.TaskSchedulingParameter{}
					if v, ok := taskSchedulingParameterListMap["param_key"].(string); ok && v != "" {
						taskSchedulingParameter.ParamKey = helper.String(v)
					}
					if v, ok := taskSchedulingParameterListMap["param_value"].(string); ok && v != "" {
						taskSchedulingParameter.ParamValue = helper.String(v)
					}
					updateTriggerTaskConfiguration.TaskSchedulingParameterList = append(updateTriggerTaskConfiguration.TaskSchedulingParameterList, &taskSchedulingParameter)
				}
			}
			if v, ok := triggerTaskConfigurationMap["bundle_id"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.BundleId = helper.String(v)
			}
			if v, ok := triggerTaskConfigurationMap["bundle_info"].(string); ok && v != "" {
				updateTriggerTaskConfiguration.BundleInfo = helper.String(v)
			}
			task.TriggerTaskConfiguration = &updateTriggerTaskConfiguration
		}

		if triggerTaskSchedulerConfigurationMap, ok := helper.InterfacesHeadMap(d, "trigger_task_scheduler_configuration"); ok {
			updateTriggerTaskSchedulerConfiguration := wedatav20250806.TriggerTaskSchedulerConfiguration{}
			if v, ok := triggerTaskSchedulerConfigurationMap["upstream_dependency_config_list"]; ok {
				for _, item := range v.([]interface{}) {
					upstreamDependencyConfigListMap := item.(map[string]interface{})
					dependencyTriggerTaskBrief := wedatav20250806.DependencyTriggerTaskBrief{}
					if v, ok := upstreamDependencyConfigListMap["task_id"].(string); ok && v != "" {
						dependencyTriggerTaskBrief.TaskId = helper.String(v)
					}
					updateTriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList = append(updateTriggerTaskSchedulerConfiguration.UpstreamDependencyConfigList, &dependencyTriggerTaskBrief)
				}
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["run_priority_type"].(int); ok {
				updateTriggerTaskSchedulerConfiguration.RunPriorityType = helper.IntInt64(v)
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["retry_wait_minute"].(int); ok {
				updateTriggerTaskSchedulerConfiguration.RetryWaitMinute = helper.IntInt64(v)
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["max_retry_number"].(int); ok {
				updateTriggerTaskSchedulerConfiguration.MaxRetryNumber = helper.IntInt64(v)
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["execution_ttl_minute"].(int); ok {
				updateTriggerTaskSchedulerConfiguration.ExecutionTTLMinute = helper.IntInt64(v)
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["wait_execution_total_ttl_minute"].(int); ok {
				updateTriggerTaskSchedulerConfiguration.WaitExecutionTotalTTLMinute = helper.IntInt64(v)
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["allow_redo_type"].(string); ok && v != "" {
				updateTriggerTaskSchedulerConfiguration.AllowRedoType = helper.String(v)
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["param_task_out_list"]; ok {
				for _, item := range v.([]interface{}) {
					paramTaskOutListMap := item.(map[string]interface{})
					outTaskParameter := wedatav20250806.OutTaskParameter{}
					if v, ok := paramTaskOutListMap["param_key"].(string); ok && v != "" {
						outTaskParameter.ParamKey = helper.String(v)
					}
					if v, ok := paramTaskOutListMap["param_value"].(string); ok && v != "" {
						outTaskParameter.ParamValue = helper.String(v)
					}
					updateTriggerTaskSchedulerConfiguration.ParamTaskOutList = append(updateTriggerTaskSchedulerConfiguration.ParamTaskOutList, &outTaskParameter)
				}
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["param_task_in_list"]; ok {
				for _, item := range v.([]interface{}) {
					paramTaskInListMap := item.(map[string]interface{})
					inTaskParameter := wedatav20250806.InTaskParameter{}
					if v, ok := paramTaskInListMap["param_key"].(string); ok && v != "" {
						inTaskParameter.ParamKey = helper.String(v)
					}
					if v, ok := paramTaskInListMap["param_desc"].(string); ok && v != "" {
						inTaskParameter.ParamDesc = helper.String(v)
					}
					if v, ok := paramTaskInListMap["from_task_id"].(string); ok && v != "" {
						inTaskParameter.FromTaskId = helper.String(v)
					}
					if v, ok := paramTaskInListMap["from_param_key"].(string); ok && v != "" {
						inTaskParameter.FromParamKey = helper.String(v)
					}
					updateTriggerTaskSchedulerConfiguration.ParamTaskInList = append(updateTriggerTaskSchedulerConfiguration.ParamTaskInList, &inTaskParameter)
				}
			}
			if v, ok := triggerTaskSchedulerConfigurationMap["task_output_registry_list"]; ok {
				for _, item := range v.([]interface{}) {
					taskOutputRegistryListMap := item.(map[string]interface{})
					taskDataRegistry := wedatav20250806.TaskDataRegistry{}
					if v, ok := taskOutputRegistryListMap["datasource_id"].(string); ok && v != "" {
						taskDataRegistry.DatasourceId = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["database_name"].(string); ok && v != "" {
						taskDataRegistry.DatabaseName = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["table_name"].(string); ok && v != "" {
						taskDataRegistry.TableName = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["partition_name"].(string); ok && v != "" {
						taskDataRegistry.PartitionName = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["data_flow_type"].(string); ok && v != "" {
						taskDataRegistry.DataFlowType = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["table_physical_id"].(string); ok && v != "" {
						taskDataRegistry.TablePhysicalId = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["db_guid"].(string); ok && v != "" {
						taskDataRegistry.DbGuid = helper.String(v)
					}
					if v, ok := taskOutputRegistryListMap["table_guid"].(string); ok && v != "" {
						taskDataRegistry.TableGuid = helper.String(v)
					}
					updateTriggerTaskSchedulerConfiguration.TaskOutputRegistryList = append(updateTriggerTaskSchedulerConfiguration.TaskOutputRegistryList, &taskDataRegistry)
				}
			}
			task.TriggerTaskSchedulerConfiguration = &updateTriggerTaskSchedulerConfiguration
		}
		request.Task = &task

		reqErr := resource.Retry(tccommon.WriteRetryTimeout, func() *resource.RetryError {
			result, e := meta.(tccommon.ProviderMeta).GetAPIV3Conn().UseWedataV20250806Client().UpdateTriggerTaskWithContext(ctx, request)
			if e != nil {
				return tccommon.RetryError(e)
			} else {
				log.Printf("[DEBUG]%s api[%s] success, request body [%s], response body [%s]\n", logId, request.GetAction(), request.ToJsonString(), result.ToJsonString())
			}
			return nil
		})
		if reqErr != nil {
			log.Printf("[CRITAL]%s update wedata trigger task failed, reason:%+v", logId, reqErr)
			return reqErr
		}
	}

	_ = projectId
	_ = taskId
	return resourceTencentCloudWedataTriggerTaskRead(d, meta)
}

func resourceTencentCloudWedataTriggerTaskDelete(d *schema.ResourceData, meta interface{}) error {
	defer tccommon.LogElapsed("resource.tencentcloud_wedata_trigger_task.delete")()
	defer tccommon.InconsistentCheck(d, meta)()

	logId := tccommon.GetLogId(tccommon.ContextNil)
	ctx := tccommon.NewResourceLifeCycleHandleFuncContext(context.Background(), logId, d, meta)

	idSplit := strings.Split(d.Id(), tccommon.FILED_SP)
	if len(idSplit) != 2 {
		return fmt.Errorf("id is broken,%s", d.Id())
	}
	projectId := idSplit[0]
	taskId := idSplit[1]

	var (
		request  = wedatav20250806.NewDeleteTriggerTaskRequest()
		response = wedatav20250806.NewDeleteTriggerTaskResponse()
	)
	request.ProjectId = &projectId
	request.TaskId = &taskId

	if v, ok := d.GetOkExists("operate_inform"); ok {
		request.OperateInform = helper.Bool(v.(bool))
	}

	if v, ok := d.GetOkExists("delete_mode"); ok {
		request.DeleteMode = helper.Bool(v.(bool))
	}

	reqErr := resource.Retry(tccommon.WriteRetryTimeout, func() *resource.RetryError {
		result, e := meta.(tccommon.ProviderMeta).GetAPIV3Conn().UseWedataV20250806Client().DeleteTriggerTaskWithContext(ctx, request)
		if e != nil {
			return tccommon.RetryError(e)
		} else {
			log.Printf("[DEBUG]%s api[%s] success, request body [%s], response body [%s]\n", logId, request.GetAction(), request.ToJsonString(), result.ToJsonString())
		}
		response = result
		return nil
	})
	if reqErr != nil {
		log.Printf("[CRITAL]%s delete wedata trigger task failed, reason:%+v", logId, reqErr)
		return reqErr
	}

	_ = response
	_ = projectId
	_ = taskId
	return nil
}
